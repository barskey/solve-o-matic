{% extends "base.html" %}

{% block content %}
<!-- Page specific JavaScript -->
<script src="static/js/calibration.js" type="text/javascript"></script>

<div class="container-fluid h-100">
	<div class="card bg-secondary h-100">
		<div class="card-header">
			<ul class="nav nav-tabs card-header-tabs bg-dark">
				<li class="nav-item">
					<a class="nav-link active" id="sites-tab" data-toggle="tab" href="#sites">Sites</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id="ranges-tab" data-toggle="tab" href="#ranges">Limits</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id="calibrate-tab" data-toggle="tab" href="#calibrate">Pos</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id="colors-tab" data-toggle="tab" href="#colors">Colors</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id="save-tab" data-toggle="tab" href="#save">Done</a>
				</li>
			</ul>
		</div>
		<div class="card-body p-1">
			<div class="tab-content">
				<div class="container-fluid tab-pane show active" id="sites">
					<div class="row h-75 align-items-center">
						<div class="col-5">
							<table class="table table-sm table-borderless">
								<tr>
									<td colspan="3" class="text-center text-warning aign-middle">Position</td>
								</tr>
								<tr>
									<td colspan="3" class="text-center"><button class="btn btn-info set-btn" data-prop="sites" data-setting="tly" data-val="-1"><i class="fa fa-caret-up"></i></button></td>
								</tr>
								<tr>
									<td class="text-right"><button class="btn btn-info set-btn" data-prop="sites" data-setting="tlx" data-val="-1"><i class="fa fa-caret-left"></i></button></td>
									<td class="text-center"><button class="btn btn-outline-info" disabled><i class="fa fa-square"></i></button></td>
									<td class="text-left"><button class="btn btn-info set-btn" data-prop="sites" data-setting="tlx" data-val="1"><i class="fa fa-caret-right"></i></button></td>
								</tr>
								<tr>
									<td colspan="3" class="text-center"><button class="btn btn-info set-btn" data-prop="sites" data-setting="tly" data-val="1"><i class="fa fa-caret-down"></i></button></td>
								</tr>
								<tr>
									<td class="text-right"><button class="btn btn-info set-btn" data-prop="sites" data-setting="size" data-val="-1"><i class="fa fa-caret-left"></i></button></td>
									<td class="text-center text-warning align-middle">Size</td>
									<td class="text-left"><button class="btn btn-info set-btn" data-prop="sites" data-setting="size" data-val="1"><i class="fa fa-caret-right"></i></button></td>
								</tr>
								<tr>
									<td class="text-right"><button class="btn btn-info set-btn" data-prop="sites" data-setting="pitch" data-val="-1"><i class="fa fa-caret-left"></i></button></td>
									<td class="text-center text-warning align-middle">Pitch</td>
									<td class="text-left"><button class="btn btn-info set-btn" data-prop="sites" data-setting="pitch" data-val="1"><i class="fa fa-caret-right"></i></button></td>
								</tr>
							</table>
						</div>
						<div class="col-1"></div>
						<div class="col" id="sites-screenshot">
							<img src="data:image/jpeg;base64,{{ img }}" width="160" height="160">
							<canvas width="160" height="160" class="position-absolute" id="sites-canvas"></canvas>
						</div>
					</div>
				</div>
				<div class="container-fluid tab-pane" id="ranges">
					<table class="table table-sm table-borderless text-center text-light">
						<tr>
							<td colspan="8" class="p-0"><h4 class="text-warning m-2">Gripper A</h4></th>
						</tr>
						<tr>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="twista" data-val="min">Min</button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="twista" data-setting="min" data-val="-10"><i class="fa fa-minus-square"></i></button></td>
							<td class="align-middle p-0"><span id="twista-min-value">{{ servo_range.tA[0] }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="twista" data-setting="min" data-val="10"><i class="fa fa-plus-square"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="twista" data-setting="max" data-val="-10"><i class="fa fa-minus-square"></i></button></td>
							<td class="align-middle p-0"><span id="twista-max-value">{{ servo_range.tA[1] }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="twista" data-setting="max" data-val="10"><i class="fa fa-plus-square"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="twista" data-val="max">Max</button></td>
						</tr>
						<tr>
							<td colspan="8" class="p-0"><h4 class="text-warning m-2">Gripper B</h4></th>
						</tr>
						<tr>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="twistb" data-val="min">Min</button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="twistb" data-setting="min" data-val="-10"><i class="fa fa-minus-square"></i></button></td>
							<td class="align-middle p-0"><span id="twistb-min-value">{{ servo_range.tB[0] }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="twistb" data-setting="min" data-val="10"><i class="fa fa-plus-square"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="twistb" data-setting="max" data-val="-10"><i class="fa fa-minus-square"></i></button></td>
							<td class="align-middle p-0"><span id="twistb-max-value">{{ servo_range.tB[1] }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="twistb" data-setting="max" data-val="10"><i class="fa fa-plus-square"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="twistb" data-val="max">Max</button></td>
						</tr>
						<tr>
							<td colspan="8"  class="align-middle p-0"><em><span class="text-warning" id="cal-results"></span></em></td>
						</tr>
					</table>
				</div>
				<div class="container-fluid tab-pane" id="colors">
					<div class="row h-75 align-items-center">
						<div class="col-5">
							<label for="sat_W">White Sat</label>
							<input type="range" class="custom-range color-slider" min="{{ 0.47 }}" max="{{ 0 }}" step="0.01" id="sat_W" value="{{ color_limit.sat_W }}">
							<label for="val_W">White Val</label>
							<input type="range" class="custom-range color-slider" min="{{ 0.31 }}" max="{{ 1 }}" step="0.01" id="val_W" value="{{ color_limit.val_W }}">
							<label for="orange_L">Red-Orange</label>
							<input type="range" class="custom-range color-slider" min="{{ 0.005 }}" max="{{ 0.055 }}" step="0.005" id="orange_L" value="{{ color_limit.orange_L }}">
							<label for="orange_H">Orange-Yellow</label>
							<input type="range" class="custom-range color-slider" min="{{ 0.03 }}" max="{{ 0.16 }}" step="0.01" id="orange_H" value="{{ color_limit.orange_H }}">
							<label for="yellow_H">Yellow-Green</label>
							<input type="range" class="custom-range color-slider" min="{{ 0.12 }}" max="{{ 0.32 }}" step="0.01" id="yellow_H" value="{{ color_limit.yellow_H }}">
							<label for="green_H">Green-Blue</label>
							<input type="range" class="custom-range color-slider" min="{{ 0.25 }}" max="{{ 0.5 }}" step="0.01" id="green_H" value="{{ color_limit.green_H }}">
							<label for="blue_H">Blue-Red</label>
							<input type="range" class="custom-range color-slider" min="{{ 0.45 }}" max="{{ 0.71 }}" step="0.01" id="blue_H" value="{{ color_limit.blue_H }}">
						</div>
						<div class="col-1"></div>
						<div class="col" id="color-screenshot">
							<img src="data:image/jpeg;base64,{{ img }}" width="160" height="160">
							<canvas width="160" height="160" class="position-absolute" id="colors-canvas"></canvas>
						</div>
					</div>
				</div>
				<div class="container-fluid tab-pane" id="calibrate">
					<table class="table table-sm table-borderless text-center text-light">
						<tr>
							<td colspan="4" class="p-0"><h4 class="text-warning m-0">Gripper A</h4></th>
							<td colspan="4" class="p-0"><h4 class="text-warning m-0">Gripper B</h4></th>
						</tr>
						<tr>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripa" data-val="open">Open</button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="open" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripa-open-value">{{ cal_data.gripa.open }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="open" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="open" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripb-open-value">{{ cal_data.gripb.open }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="open" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripb" data-val="open">Open</button></td>
						</tr>
						<tr>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripa" data-val="load">Load</button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="load" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripa-load-value">{{ cal_data.gripa.load }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="load" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="load" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripb-load-value">{{ cal_data.gripb.load }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="load" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripb" data-val="load">Load</button></td>
						</tr>
						<tr>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripa" data-val="close">Close</button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="close" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripa-close-value">{{ cal_data.gripa.close }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="close" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="close" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripb-close-value">{{ cal_data.gripb.close }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="close" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripb" data-val="close">Close</button></td>
						</tr>
						<tr>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripa" data-val="ccw">CCW</button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="ccw" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripa-ccw-value">{{ cal_data.gripa.ccw }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="ccw" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="ccw" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripb-ccw-value">{{ cal_data.gripb.ccw }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="ccw" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripb" data-val="ccw">CCW</i></button></td>
						</tr>
						<tr>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripa" data-val="center">Center</button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="center" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripa-center-value">{{ cal_data.gripa.center }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="center" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="center" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripb-center-value">{{ cal_data.gripb.center }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="center" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripb" data-val="center">Center</button></td>
						</tr>
						<tr>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripa" data-val="cw">CW</button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="cw" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripa-cw-value">{{ cal_data.gripa.cw }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripa" data-setting="cw" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="cw" data-val="-1"><i class="fa fa-caret-square-left"></i></button></td>
							<td class="align-middle p-0"><span id="gripb-cw-value">{{ cal_data.gripb.cw }}</span></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-outline-info cal-btn" data-prop="gripb" data-setting="cw" data-val="1"><i class="fa fa-caret-square-right"></i></button></td>
							<td class="align-middle p-0"><button type="button" class="btn btn-sm btn-info btn-block move-btn" data-prop="gripb" data-val="cw">CW</i></button></td>
						</tr>
						<tr>
							<td colspan="8"  class="align-middle p-0"><em><span class="text-warning" id="cal-results"></span></em></td>
						</tr>
					</table>
				</div>
				<div class="container-fluid tab-pane" id="save">
					<div class="row h-50 align-items-center">
						<div class="col text-center">
							<h4 class="text-warning">All calibration settings saved!</h4>
						</div>
					</div>
					<div class="row">
						<div class="col text-center">
							<a class="btn btn-warning" href="/index">Main Menu</a> 
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}